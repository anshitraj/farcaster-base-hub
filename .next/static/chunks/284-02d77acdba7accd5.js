"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{3284:function(e,t,a){a.d(t,{Z:function(){return E}});var s=a(7437),r=a(7648),n=a(3145),l=a(9376),i=a(8239),o=a(3566),c=a(3247),d=a(9397),u=a(4766),m=a(376),f=a(2265),h=a(9232),p=a(1312),x=a(3448);let b=p.zt,g=p.fC,w=p.xz,v=f.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,s.jsx)(p.VY,{ref:t,sideOffset:r,className:(0,x.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})});v.displayName=p.VY.displayName;var y=a(828);function j(){let[e,t]=(0,f.useState)(null),[a,n]=(0,f.useState)(!0),{isAuthenticated:i,loading:o}=(0,y.a)(),c=(0,l.useRouter)();return((0,f.useEffect)(()=>{if(o||!i){t(0),n(!1);return}let e=!0;async function a(){try{let a=await fetch("/api/points",{credentials:"include"});if(!e)return;if(a.ok){let e=await a.json();t(e.totalPoints||0)}else a.status,t(0)}catch(a){if(!e)return;console.error("Error fetching points:",a),t(0)}finally{e&&n(!1)}}a();let s=()=>{e&&setTimeout(a,1e3)},r=()=>{e&&(t(0),n(!1))},l=()=>{e&&setTimeout(a,500)};return window.addEventListener("walletConnected",s),window.addEventListener("walletDisconnected",r),window.addEventListener("pointsUpdated",l),()=>{e=!1,window.removeEventListener("walletConnected",s),window.removeEventListener("walletDisconnected",r),window.removeEventListener("pointsUpdated",l)}},[i,o]),a||null===e)?(0,s.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg bg-base-cyan/10 border border-base-cyan/30",children:[(0,s.jsx)(h.Z,{className:"w-4 h-4 text-base-cyan animate-pulse"}),(0,s.jsx)("span",{className:"text-xs font-semibold text-base-cyan",children:"..."})]}):(0,s.jsx)(b,{children:(0,s.jsxs)(g,{children:[(0,s.jsx)(w,{asChild:!0,children:(0,s.jsxs)(r.default,{href:"/quests",className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg bg-base-cyan/10 border border-base-cyan/30 hover:bg-base-cyan/20 transition-colors cursor-pointer",onClick:e=>{e.preventDefault(),c.push("/quests")},children:[(0,s.jsx)(h.Z,{className:"w-4 h-4 text-base-cyan fill-base-cyan"}),(0,s.jsx)("span",{className:"text-xs font-semibold text-base-cyan",children:e.toLocaleString()})]})}),(0,s.jsxs)(v,{children:[(0,s.jsx)("p",{className:"text-sm",children:"Your points balance"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Click to view all quests and ways to earn points!"})]})]})})}var N=a(2447),A=a(279);function E(e){let{onMenuClick:t}=e,[a,h]=(0,f.useState)(!1),[p,x]=(0,f.useState)(""),[b,g]=(0,f.useState)(0),w=(0,l.useRouter)(),v=(0,l.usePathname)(),y=(0,l.useSearchParams)();(0,f.useEffect)(()=>{x(y.get("search")||"")},[y]),(0,f.useEffect)(()=>{async function e(){try{let e=await fetch("/api/notifications?unread=true&limit=1",{credentials:"include"});if(e.ok){let t=await e.json();g(t.unreadCount||0)}}catch(e){console.error("Error fetching unread count:",e)}}e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]);let E=function(e,t){let[a,s]=(0,f.useState)(e);return(0,f.useEffect)(()=>{let t=setTimeout(()=>{s(e)},500);return()=>{clearTimeout(t)}},[e,500]),a}(p,0);(0,f.useEffect)(()=>{let e=new URLSearchParams(y.toString());E.trim()?(e.set("search",E.trim()),e.delete("page")):e.delete("search");let t="/apps?".concat(e.toString());"/apps"===v?w.replace(t,{scroll:!1}):"/"===v&&E.trim()&&w.push(t)},[E,v,w,y]);let k=e=>{x(e)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("header",{className:"sticky top-0 z-50 bg-black/80 backdrop-blur-2xl border-b border-gray-800/50 shadow-lg",children:(0,s.jsxs)("div",{className:"px-6 py-5 flex items-center justify-between gap-4",children:[(0,s.jsx)(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:t,className:"lg:hidden p-2.5 hover:bg-gray-800 rounded-xl transition-all duration-300","aria-label":"Open menu",children:(0,s.jsx)(o.Z,{className:"w-6 h-6 text-gray-300"})}),(0,s.jsx)(r.default,{href:"/",className:"flex-shrink-0 hover:opacity-80 transition-opacity",children:(0,s.jsx)(n.default,{src:"/logo.png",alt:"Mini App Store",width:300,height:100,className:"h-20 md:h-24 w-auto",priority:!0})}),(0,s.jsx)("div",{className:"flex-1 max-w-2xl mx-4 hidden md:block",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(c.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 z-10"}),(0,s.jsx)(A.I,{type:"text",placeholder:"Search mini apps...",value:p,onChange:e=>k(e.target.value),onKeyDown:e=>{if("Enter"===e.key&&(e.preventDefault(),"/apps"!==v)){let e=new URLSearchParams;p.trim()&&e.set("search",p.trim()),w.push("/apps?".concat(e.toString()))}},className:"pl-12 pr-4 h-11 rounded-full bg-gray-900 border border-gray-800 text-white placeholder:text-gray-500 focus-visible:ring-blue-500 focus-visible:ring-2 focus-visible:border-blue-500"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[(0,s.jsx)(r.default,{href:"/submit",children:(0,s.jsxs)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"hidden md:flex items-center gap-2 px-4 py-2 rounded-lg bg-[#1E3A5F] border border-[#2A5F8F] text-white hover:bg-[#2A5F8F] transition-all duration-300",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm font-semibold",children:"List a project"})]})}),(0,s.jsx)(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"md:hidden p-2.5 hover:bg-gray-800 rounded-xl transition-all duration-300",onClick:()=>w.push("/search"),"aria-label":"Search",children:(0,s.jsx)(c.Z,{className:"w-5 h-5 text-gray-300"})}),(0,s.jsxs)(i.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"relative p-2.5 hover:bg-gray-800 rounded-xl transition-all duration-300",onClick:()=>h(!0),"aria-label":"Notifications",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5 text-gray-300"}),b>0&&(0,s.jsx)("span",{className:"absolute top-1 right-1 min-w-[18px] h-[18px] bg-red-500 rounded-full flex items-center justify-center text-[10px] font-bold text-white px-1 animate-pulse",children:b>99?"99+":b})]}),(0,s.jsx)(j,{}),(0,s.jsx)(m.Z,{})]})]})}),(0,s.jsx)(N.Z,{isOpen:a,onClose:()=>h(!1)})]})}},2447:function(e,t,a){a.d(t,{Z:function(){return p}});var s=a(7437),r=a(2265),n=a(7586),l=a(8239),i=a(1671),o=a(9322),c=a(2023),d=a(3245),u=a(4766),m=a(2489),f=a(456),h=a(7648);function p(e){let{isOpen:t,onClose:a,onNotificationRead:p}=e,[x,b]=(0,r.useState)([]),[g,w]=(0,r.useState)(!0);(0,r.useEffect)(()=>{async function e(){try{let e=await fetch("/api/notifications",{credentials:"include"});if(e.ok){let t=await e.json();b(t.notifications||[])}else b([])}catch(e){console.error("Error fetching notifications:",e),b([])}finally{w(!1)}}t&&e()},[t]);let v=x.filter(e=>!e.read).length,y=e=>{switch(e){case"success":return(0,s.jsx)(i.Z,{className:"w-5 h-5 text-green-500"});case"error":return(0,s.jsx)(o.Z,{className:"w-5 h-5 text-red-500"});case"warning":return(0,s.jsx)(o.Z,{className:"w-5 h-5 text-yellow-500"});case"badge":case"new_app":case"trending":return(0,s.jsx)(c.Z,{className:"w-5 h-5 text-purple-500"});default:return(0,s.jsx)(d.Z,{className:"w-5 h-5 text-base-blue"})}},j=e=>{switch(e){case"success":return"bg-green-500/10 border-green-500/20";case"error":return"bg-red-500/10 border-red-500/20";case"warning":return"bg-yellow-500/10 border-yellow-500/20";case"badge":case"new_app":case"trending":case"premium_offer":return"bg-purple-500/10 border-purple-500/20";default:return"bg-base-blue/10 border-base-blue/20"}},N=async e=>{try{(await fetch("/api/notifications/".concat(e,"/read"),{method:"PATCH",credentials:"include"})).ok&&(b(t=>t.map(t=>t.id===e?{...t,read:!0}:t)),p&&p())}catch(e){console.error("Error marking notification as read:",e)}},A=async()=>{try{(await fetch("/api/notifications/read-all",{method:"PATCH",credentials:"include"})).ok&&(b(e=>e.map(e=>({...e,read:!0}))),p&&p())}catch(e){console.error("Error marking all notifications as read:",e)}};return(0,s.jsx)(n.M,{children:t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 lg:z-50"}),(0,s.jsxs)(l.E.aside,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:30,stiffness:300},className:"fixed right-0 top-0 h-screen w-full max-w-md bg-gradient-to-b from-[#1A1A1A] to-[#141414] border-l border-[#2A2A2A] z-50 shadow-2xl flex flex-col",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-[#2A2A2A]/50 bg-gradient-to-r from-[#1A1A1A] to-[#141414]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-base-blue/20 to-purple-500/20 flex items-center justify-center border border-base-blue/30",children:(0,s.jsx)(u.Z,{className:"w-5 h-5 text-base-blue"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-extrabold text-white",children:"Notifications"}),v>0&&(0,s.jsxs)("p",{className:"text-xs text-[#A0A4AA] mt-0.5",children:[v," unread"]})]})]}),(0,s.jsx)(l.E.button,{whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},onClick:a,className:"p-2 hover:bg-[#2A2A2A]/80 rounded-xl transition-all duration-300","aria-label":"Close notifications",children:(0,s.jsx)(m.Z,{className:"w-5 h-5 text-[#AAA] hover:text-white transition-colors"})})]}),v>0&&(0,s.jsx)(l.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:A,className:"w-full px-4 py-2 bg-base-blue/10 hover:bg-base-blue/20 border border-base-blue/30 rounded-xl text-sm font-semibold text-base-blue transition-all duration-300",children:"Mark all as read"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:g?(0,s.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"h-20 bg-gradient-to-br from-[#141A24] to-[#0F1419] rounded-2xl animate-pulse border border-[#1F2733]"},t))}):0===x.length?(0,s.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col items-center justify-center h-full text-center py-16",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-base-blue/20 to-purple-500/20 flex items-center justify-center mb-4 border border-base-blue/30",children:(0,s.jsx)(u.Z,{className:"w-10 h-10 text-base-blue/50"})}),(0,s.jsx)("p",{className:"text-lg font-semibold text-white mb-2",children:"All caught up!"}),(0,s.jsx)("p",{className:"text-sm text-[#A0A4AA]",children:"You don't have any notifications yet."})]}):x.map((e,t)=>(0,s.jsxs)(l.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1*t},onClick:()=>{e.read||N(e.id),e.link&&(window.location.href=e.link)},className:"group relative p-4 rounded-2xl border cursor-pointer transition-all duration-300 hover:scale-[1.02] ".concat(e.read?"bg-[#141A24] border-[#1F2733] opacity-60":"".concat(j(e.type)," border-opacity-50")),children:[!e.read&&(0,s.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 w-2 h-2 bg-base-blue rounded-full"}),(0,s.jsxs)("div",{className:"flex gap-3 pl-4",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:y(e.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-white mb-1 line-clamp-1",children:e.title}),(0,s.jsx)("p",{className:"text-xs text-[#A0A4AA] mb-2 line-clamp-2",children:e.message}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs text-[#888]",children:(0,f.Q)(new Date(e.createdAt),{addSuffix:!0})}),e.link&&(0,s.jsx)(h.default,{href:e.link,className:"text-xs text-base-blue font-semibold hover:underline",children:"View â†’"})]})]})]}),(0,s.jsx)("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 -translate-x-full group-hover:translate-x-full"})]},e.id))}),(0,s.jsx)("div",{className:"p-4 border-t border-[#2A2A2A]/50 bg-gradient-to-r from-[#1A1A1A] to-[#141414]",children:(0,s.jsx)(l.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full px-4 py-3 bg-gradient-to-r from-base-blue to-purple-500 text-white rounded-xl text-sm font-bold hover:shadow-[0_0_20px_rgba(0,102,255,0.5)] transition-all duration-300",children:"View All Notifications"})})]})]})})}},376:function(e,t,a){a.d(t,{Z:function(){return E}});var s=a(7437),r=a(2265),n=a(3145),l=a(2381),i=a(3340),o=a(1804),c=a(401),d=a(8867),u=a(2369),m=a(8906),f=a(8728),h=a(7692),p=a(85),x=a(407),b=a(519),g=a(3448);let w=p.fC,v=p.xz;p.ZA,p.Uv,p.Tr,p.Ee,r.forwardRef((e,t)=>{let{className:a,inset:r,children:n,...l}=e;return(0,s.jsxs)(p.fF,{ref:t,className:(0,g.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",r&&"pl-8",a),...l,children:[n,(0,s.jsx)(x.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=p.fF.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(p.tu,{ref:t,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=p.tu.displayName;let y=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,s.jsx)(p.Uv,{children:(0,s.jsx)(p.VY,{ref:t,sideOffset:r,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});y.displayName=p.VY.displayName;let j=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(p.ck,{ref:t,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r&&"pl-8",a),...n})});j.displayName=p.ck.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:n,...l}=e;return(0,s.jsxs)(p.oC,{ref:t,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a),checked:n,...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(p.wU,{children:(0,s.jsx)(c.Z,{className:"h-4 w-4"})})}),r]})}).displayName=p.oC.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(p.Rk,{ref:t,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(p.wU,{children:(0,s.jsx)(b.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=p.Rk.displayName,r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(p.__,{ref:t,className:(0,g.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...n})}).displayName=p.__.displayName;let N=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(p.Z0,{ref:t,className:(0,g.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});N.displayName=p.Z0.displayName;var A=a(6936);function E(){let[e,t]=(0,r.useState)(null),[a,p]=(0,r.useState)(!0),[x,b]=(0,r.useState)(!1),[g,E]=(0,r.useState)(!1),{toast:k}=(0,i.pm)();async function C(){try{let e=await fetch("/api/auth/wallet",{method:"GET",credentials:"include"});if(e.ok){let a=await e.json();a.wallet?await S(a.wallet):t(null)}else e.status,t(null)}catch(e){t(null)}finally{p(!1)}}async function S(e){try{var a,s,r;let n=await T(e),l=null,i=null,o=!1;n&&(l=await Z(e),i=await _(e,l));try{let t=await fetch("/api/developers/".concat(e),{credentials:"include"});if(t.ok){let e=await t.json();o=(null===(a=e.developer)||void 0===a?void 0:a.isAdmin)||!1,(null===(s=e.developer)||void 0===s?void 0:s.name)&&(l=e.developer.name)}}catch(e){}try{let e=await fetch("/api/developer/profile",{credentials:"include"});if(e.ok){let t=await e.json();(null===(r=t.developer)||void 0===r?void 0:r.name)&&!l&&(l=t.developer.name)}}catch(e){}t({wallet:e,name:l,avatar:i,isBaseWallet:n,isAdmin:o})}catch(a){console.error("Profile fetch error:",a),t({wallet:e,name:null,avatar:null,isBaseWallet:!1,isAdmin:!1})}}async function T(e){try{let e=(0,A.z)();if(!e)return!1;if(e.isBase||e.isCoinbaseWallet||e.isCoinbaseBrowser)return!0;let t=await e.request({method:"eth_chainId"});if("0x2105"===t||"0x14a34"===t)return!0}catch(e){console.error("Chain check error:",e)}return!1}async function Z(e){return null}async function _(e,t){return"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(e,"&backgroundColor=b6e3f4,c0aede,d1d4f9")}(0,r.useEffect)(()=>{let t=!0;if("true"===sessionStorage.getItem("logoutInProgress"))return sessionStorage.removeItem("logoutInProgress"),p(!1),()=>{t=!1};!async function(){await C()}();let a=null,s=null,r=null;return(r=(0,A.z)())&&e&&(a=()=>{t&&C()},s=()=>{t&&C()},r.on("accountsChanged",a),r.on("chainChanged",s)),()=>{t=!1,r&&(a&&r.removeListener("accountsChanged",a),s&&r.removeListener("chainChanged",s))}},[e]);let I=async()=>{if(!x)try{let a;b(!0);let s=(0,A.z)();if(!s){k({title:"No Wallet Found",description:"Please install MetaMask or open in Base App",variant:"destructive"}),b(!1);return}let r=await s.request({method:"eth_requestAccounts"});if(!r||0===r.length)throw Error("No account selected");let n=r[0],l="Login to Mini App Store";try{a=await s.request({method:"personal_sign",params:[l,n]})}catch(r){var e,t;if(4001===r.code||(null===(e=r.message)||void 0===e?void 0:e.includes("reject")))throw Error("Signature request rejected");try{a=await s.request({method:"personal_sign",params:[n,l]})}catch(e){if(4001===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("reject")))throw Error("Signature request rejected");throw Error(e.message||"Failed to get signature")}}let i=await fetch("/api/auth/wallet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet:n,signature:a,message:l})});if(i.ok){let e=await i.json();await S(e.wallet||n),window.dispatchEvent(new Event("walletConnected")),k({title:"Wallet Connected",description:"Successfully connected your wallet"}),setTimeout(()=>{window.location.reload()},1e3)}else{let e=await i.json().catch(()=>({}));throw Error(e.error||"Authentication failed")}}catch(e){console.error("Connection error:",e),k({title:"Connection Failed",description:e.message||"Failed to connect wallet. Please try again.",variant:"destructive"})}finally{b(!1)}},z=async()=>{if(e)try{await navigator.clipboard.writeText(e.wallet),E(!0),k({title:"Copied!",description:"Wallet address copied to clipboard"}),setTimeout(()=>E(!1),2e3)}catch(e){console.error("Copy error:",e),k({title:"Copy Failed",description:"Failed to copy address",variant:"destructive"})}},F=async()=>{try{if(sessionStorage.setItem("logoutInProgress","true"),(await fetch("/api/auth/wallet",{method:"DELETE",credentials:"include"})).ok){t(null);try{localStorage.removeItem("walletAddress")}catch(e){}k({title:"Disconnected",description:"Wallet disconnected successfully. You can now connect a different wallet."}),window.dispatchEvent(new CustomEvent("walletDisconnected")),setTimeout(()=>{sessionStorage.removeItem("logoutInProgress"),window.location.reload()},500)}else throw sessionStorage.removeItem("logoutInProgress"),Error("Failed to logout")}catch(e){console.error("Disconnect error:",e),sessionStorage.removeItem("logoutInProgress"),k({title:"Logout Failed",description:"Failed to disconnect. Please try again.",variant:"destructive"})}};if(a)return(0,s.jsx)("div",{className:"w-9 h-9 rounded-full bg-muted animate-pulse"});if(!e)return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("a",{href:"/api/auth/farcaster/login",className:"hidden sm:flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-purple-600/20 hover:bg-purple-600/30 border border-purple-500/30 text-purple-300 text-xs font-medium transition-all",title:"Login with Farcaster",children:"Farcaster"}),(0,s.jsxs)(l.z,{onClick:I,disabled:x,className:"bg-base-blue hover:bg-base-blue/90 text-white shadow-lg shadow-base-blue/30",size:"sm",children:[(0,s.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),x?"Connecting...":"Connect"]})]});let D=e.name||"".concat(e.wallet.slice(0,6),"...").concat(e.wallet.slice(-4)),L="".concat(e.wallet.slice(0,6),"...").concat(e.wallet.slice(-4)),P=e.avatar||(e.isBaseWallet?"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(e.wallet,"&backgroundColor=b6e3f4,c0aede,d1d4f9&hairColor=77311d,4a312c"):"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(e.wallet,"&backgroundColor=ffffff&hairColor=77311d"));return(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(w,{children:[(0,s.jsx)(v,{asChild:!0,children:(0,s.jsxs)("button",{className:"flex items-center gap-2 hover:opacity-80 transition-opacity focus:outline-none focus:ring-2 focus:ring-base-blue/50 rounded-full p-1",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.default,{src:P,alt:D,width:36,height:36,className:"w-9 h-9 rounded-full border-2 border-white/20 shadow-lg",unoptimized:!0}),e.isBaseWallet&&(0,s.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 bg-base-blue rounded-full flex items-center justify-center border-2 border-[#0B0F19] shadow-md",children:(0,s.jsx)("span",{className:"text-[8px] text-white font-bold",children:"B"})})]}),(0,s.jsx)("span",{className:"hidden lg:block text-sm font-medium text-foreground max-w-[120px] truncate font-mono",children:L})]})}),(0,s.jsxs)(y,{align:"end",className:"glass-card border-white/10 w-64",children:[(0,s.jsx)("div",{className:"px-4 py-3 border-b border-white/10",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(n.default,{src:P,alt:D,width:48,height:48,className:"w-12 h-12 rounded-full border-2 border-base-blue/50",unoptimized:!0}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[e.name&&(0,s.jsx)("p",{className:"text-sm font-semibold truncate",children:e.name}),e.isBaseWallet&&(0,s.jsx)("p",{className:"text-xs text-base-blue mt-0.5",children:"Base Wallet"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground font-mono mt-1 truncate",children:e.wallet})]})]})}),(0,s.jsx)(j,{onClick:z,className:"cursor-pointer",children:g?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{className:"w-4 h-4 mr-2 text-green-500"}),"Copied!"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Copy Address"]})}),(0,s.jsx)(N,{}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsxs)("a",{href:"/dashboard",className:"cursor-pointer",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Dashboard"]})}),!e.isAdmin&&(0,s.jsx)(j,{asChild:!0,children:(0,s.jsxs)("a",{href:"/verify",className:"cursor-pointer",children:[(0,s.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),e.isBaseWallet?"Verify Developer":"Verify Account"]})}),e.isAdmin&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N,{}),(0,s.jsx)(j,{asChild:!0,children:(0,s.jsxs)("a",{href:"/admin",className:"cursor-pointer",children:[(0,s.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Admin Portal"]})})]}),(0,s.jsx)(N,{}),(0,s.jsxs)(j,{onClick:F,className:"text-destructive focus:text-destructive cursor-pointer",children:[(0,s.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})})}},2381:function(e,t,a){a.d(t,{d:function(){return o},z:function(){return c}});var s=a(7437),r=a(2265),n=a(7495),l=a(535),i=a(3448);let o=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:l,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:r,size:l,className:a})),ref:t,...d})});c.displayName="Button"},279:function(e,t,a){a.d(t,{I:function(){return l}});var s=a(7437),r=a(2265),n=a(3448);let l=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},828:function(e,t,a){a.d(t,{a:function(){return r}});var s=a(2265);function r(){let[e,t]=(0,s.useState)({isAuthenticated:!1,wallet:null,loading:!0});return(0,s.useEffect)(()=>{let e=!0;async function a(){try{let a=await fetch("/api/auth/wallet",{credentials:"include"});if(!e)return;if(a.ok){let e=await a.json();t({isAuthenticated:!!e.wallet,wallet:e.wallet||null,loading:!1})}else t({isAuthenticated:!1,wallet:null,loading:!1})}catch(a){if(!e)return;console.error("Auth check error:",a),t({isAuthenticated:!1,wallet:null,loading:!1})}}a();let s=()=>{e&&a()},r=()=>{e&&t({isAuthenticated:!1,wallet:null,loading:!1})};return window.addEventListener("walletConnected",s),window.addEventListener("walletDisconnected",r),()=>{e=!1,window.removeEventListener("walletConnected",s),window.removeEventListener("walletDisconnected",r)}},[]),e}},3340:function(e,t,a){a.d(t,{pm:function(){return m}});var s=a(2265);let r=0,n=new Map,l=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=i(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(c);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},3448:function(e,t,a){a.d(t,{cn:function(){return n}});var s=a(1994),r=a(3335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}},6936:function(e,t,a){a.d(t,{z:function(){return s}});function s(){let e=window;return e.ethereum?(e.ethereum.isMetaMask||e.ethereum.isCoinbaseWallet||e.ethereum.isCoinbaseBrowser||e.ethereum.isBase,e.ethereum):e.coinbaseWalletExtension?e.coinbaseWalletExtension:e.wallet?e.wallet:null}}}]);