"use strict";(()=>{var e={};e.id=20,e.ids=[20],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},69982:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>m,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>u});var a={};t.r(a),t.d(a,{GET:()=>d});var n=t(49303),i=t(88716),p=t(60670),s=t(87070),o=t(75748);async function d(){try{let e=await o._.miniApp.findMany({where:{status:"approved"},include:{developer:{select:{id:!0,wallet:!0,name:!0,avatar:!0,verified:!0}}},orderBy:[{ratingCount:"desc"},{clicks:"desc"}],take:50});if(0===e.length)return s.NextResponse.json({apps:[]});let r=e.map(e=>{let r=e.developer?.verified?100:0,t=2*(e.ratingCount||0),a=.1*(e.clicks||0);return{app:e,score:t+a+r}}).sort((e,r)=>e.app.developer?.verified&&!r.app.developer?.verified?-1:!e.app.developer?.verified&&r.app.developer?.verified?1:r.score-e.score).slice(0,20).map(({app:e},r)=>({id:e.id,name:e.name,description:e.description,iconUrl:e.iconUrl,headerImageUrl:e.headerImageUrl,category:e.category,tags:e.tags||[],ratingAverage:e.ratingAverage,ratingCount:e.ratingCount,clicks:e.clicks,installs:e.installs,developer:e.developer,rank:r+1}));return s.NextResponse.json({apps:r})}catch(e){return console.error("Get ranked trending apps error:",e),s.NextResponse.json({apps:[]})}}let l=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/apps/trending/ranked/route",pathname:"/api/apps/trending/ranked",filename:"route",bundlePath:"app/api/apps/trending/ranked/route"},resolvedPagePath:"E:\\base\\store\\farcaster-base-hub\\src\\app\\api\\apps\\trending\\ranked\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:u,serverHooks:g}=l,v="/api/apps/trending/ranked/route";function m(){return(0,p.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:u})}},75748:(e,r,t)=>{t.d(r,{_:()=>n});var a=t(53524);let n=global.prisma??new a.PrismaClient({log:["error"]})}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[9276,5972],()=>t(69982));module.exports=a})();