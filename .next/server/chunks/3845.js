"use strict";exports.id=3845,exports.ids=[3845],exports.modules={18880:(t,e,r)=>{function i(t){if(!Number.isSafeInteger(t)||t<0)throw Error(`Wrong positive integer: ${t}`)}function n(t,...e){if(!(t instanceof Uint8Array))throw Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function o(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");i(t.outputLen),i(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function l(t,e){n(t);let r=e.outputLen;if(t.length<r)throw Error(`digestInto() expects output buffer of length at least ${r}`)}r.d(e,{Gg:()=>s,J8:()=>l,Rx:()=>i,aI:()=>n,vp:()=>o})},62833:(t,e,r)=>{r.d(e,{N:()=>o});var i=r(18880),n=r(48578);class o extends n.kb{constructor(t,e,r,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,n.GL)(this.buffer)}update(t){(0,i.Gg)(this);let{view:e,buffer:r,blockLen:o}=this,s=(t=(0,n.O0)(t)).length;for(let i=0;i<s;){let l=Math.min(o-this.pos,s-i);if(l===o){let e=(0,n.GL)(t);for(;o<=s-i;i+=o)this.process(e,i);continue}r.set(t.subarray(i,i+l),this.pos),this.pos+=l,i+=l,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,i.Gg)(this),(0,i.J8)(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:o,isLE:s}=this,{pos:l}=this;e[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>o-l&&(this.process(r,0),l=0);for(let t=l;t<o;t++)e[t]=0;(function(t,e,r,i){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,i);let n=BigInt(32),o=BigInt(4294967295),s=Number(r>>n&o),l=Number(r&o),u=i?4:0,a=i?0:4;t.setUint32(e+u,s,i),t.setUint32(e+a,l,i)})(r,o-8,BigInt(8*this.length),s),this.process(r,0);let u=(0,n.GL)(t),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let f=a/4,h=this.get();if(f>h.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)u.setUint32(4*t,h[t],s)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:i,finished:n,destroyed:o,pos:s}=this;return t.length=i,t.pos=s,t.finished=n,t.destroyed=o,i%e&&t.buffer.set(r),t}}},17623:(t,e,r)=>{r.d(e,{b:()=>s});var i=r(18880),n=r(48578);class o extends n.kb{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,i.vp)(t);let r=(0,n.O0)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let t=0;t<s.length;t++)s[t]^=54;this.iHash.update(s),this.oHash=t.create();for(let t=0;t<s.length;t++)s[t]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,i.Gg)(this),this.iHash.update(t),this}digestInto(t){(0,i.Gg)(this),(0,i.aI)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:i,destroyed:n,blockLen:o,outputLen:s}=this;return t.finished=i,t.destroyed=n,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let s=(t,e,r)=>new o(t,e).update(r).digest();s.create=(t,e)=>new o(t,e)},66632:(t,e,r)=>{r.d(e,{J:()=>h});var i=r(62833),n=r(48578);let o=(t,e,r)=>t&e^~t&r,s=(t,e,r)=>t&e^t&r^e&r,l=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),u=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),a=new Uint32Array(64);class f extends i.N{constructor(){super(64,32,8,!1),this.A=0|u[0],this.B=0|u[1],this.C=0|u[2],this.D=0|u[3],this.E=0|u[4],this.F=0|u[5],this.G=0|u[6],this.H=0|u[7]}get(){let{A:t,B:e,C:r,D:i,E:n,F:o,G:s,H:l}=this;return[t,e,r,i,n,o,s,l]}set(t,e,r,i,n,o,s,l){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|o,this.G=0|s,this.H=0|l}process(t,e){for(let r=0;r<16;r++,e+=4)a[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=a[t-15],r=a[t-2],i=(0,n.np)(e,7)^(0,n.np)(e,18)^e>>>3,o=(0,n.np)(r,17)^(0,n.np)(r,19)^r>>>10;a[t]=o+a[t-7]+i+a[t-16]|0}let{A:r,B:i,C:u,D:f,E:h,F:d,G:c,H:g}=this;for(let t=0;t<64;t++){let e=g+((0,n.np)(h,6)^(0,n.np)(h,11)^(0,n.np)(h,25))+o(h,d,c)+l[t]+a[t]|0,p=((0,n.np)(r,2)^(0,n.np)(r,13)^(0,n.np)(r,22))+s(r,i,u)|0;g=c,c=d,d=h,h=f+e|0,f=u,u=i,i=r,r=e+p|0}r=r+this.A|0,i=i+this.B|0,u=u+this.C|0,f=f+this.D|0,h=h+this.E|0,d=d+this.F|0,c=c+this.G|0,g=g+this.H|0,this.set(r,i,u,f,h,d,c,g)}roundClean(){a.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let h=(0,n.hE)(()=>new f)},48578:(t,e,r)=>{r.d(e,{kb:()=>g,oY:()=>h,U5:()=>y,eV:()=>c,GL:()=>u,O6:()=>m,np:()=>a,O0:()=>d,Jq:()=>l,hE:()=>w});var i=r(6005),n=r.t(i,2);let o=n&&"object"==typeof n&&"webcrypto"in n?i.webcrypto:void 0,s=t=>t instanceof Uint8Array,l=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),u=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),a=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw Error("Non little-endian hardware is not supported");let f=async()=>{};async function h(t,e,r){let i=Date.now();for(let n=0;n<t;n++){r(n);let t=Date.now()-i;t>=0&&t<e||(await f(),i+=t)}}function d(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}(t)),!s(t))throw Error(`expected Uint8Array, got ${typeof t}`);return t}function c(...t){let e=new Uint8Array(t.reduce((t,e)=>t+e.length,0)),r=0;return t.forEach(t=>{if(!s(t))throw Error("Uint8Array expected");e.set(t,r),r+=t.length}),e}class g{clone(){return this._cloneInto()}}let p={}.toString;function y(t,e){if(void 0!==e&&"[object Object]"!==p.call(e))throw Error("Options should be object or undefined");return Object.assign(t,e)}function w(t){let e=e=>t().update(d(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function m(t=32){if(o&&"function"==typeof o.getRandomValues)return o.getRandomValues(new Uint8Array(t));throw Error("crypto.getRandomValues must be defined")}},22736:(t,e,r)=>{r.d(e,{K:()=>h});var i=r(83045),n=r(14925),o=r(62819);let s=BigInt(0),l=BigInt(36);function u(t){let e=(t=t.toLowerCase()).substring(2).split(""),r=new Uint8Array(40);for(let t=0;t<40;t++)r[t]=e[t].charCodeAt(0);let o=(0,n.Pw)((0,i.w)(r));for(let t=0;t<40;t+=2)o[t>>1]>>4>=8&&(e[t]=e[t].toUpperCase()),(15&o[t>>1])>=8&&(e[t+1]=e[t+1].toUpperCase());return"0x"+e.join("")}let a={};for(let t=0;t<10;t++)a[String(t)]=String(t);for(let t=0;t<26;t++)a[String.fromCharCode(65+t)]=String(10+t);let f=function(){let t={};for(let e=0;e<36;e++)t["0123456789abcdefghijklmnopqrstuvwxyz"[e]]=BigInt(e);return t}();function h(t){if((0,o.en)("string"==typeof t,"invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);let e=u(t);return(0,o.en)(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){(0,o.en)(t.substring(2,4)===function(t){let e=(t=(t=t.toUpperCase()).substring(4)+t.substring(0,2)+"00").split("").map(t=>a[t]).join("");for(;e.length>=15;){let t=e.substring(0,15);e=parseInt(t,10)%97+e.substring(t.length)}let r=String(98-parseInt(e,10)%97);for(;r.length<2;)r="0"+r;return r}(t),"bad icap checksum","address",t);let e=(function(t){t=t.toLowerCase();let e=s;for(let r=0;r<t.length;r++)e=e*l+f[t[r]];return e})(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return u("0x"+e)}(0,o.en)(!1,"invalid address","address",t)}},83045:(t,e,r)=>{r.d(e,{w:()=>U});var i=r(18880);let n=BigInt(4294967296-1),o=BigInt(32),s=(t,e,r)=>t<<r|e>>>32-r,l=(t,e,r)=>e<<r|t>>>32-r,u=(t,e,r)=>e<<r-32|t>>>64-r,a=(t,e,r)=>t<<r-32|e>>>64-r;var f=r(48578);let[h,d,c]=[[],[],[]],g=BigInt(0),p=BigInt(1),y=BigInt(2),w=BigInt(7),m=BigInt(256),b=BigInt(113);for(let t=0,e=p,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],h.push(2*(5*i+r)),d.push((t+1)*(t+2)/2%64);let n=g;for(let t=0;t<7;t++)(e=(e<<p^(e>>w)*b)%m)&y&&(n^=p<<(p<<BigInt(t))-p);c.push(n)}let[E,v]=function(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let s=0;s<t.length;s++){let{h:l,l:u}=function(t,e=!1){return e?{h:Number(t&n),l:Number(t>>o&n)}:{h:0|Number(t>>o&n),l:0|Number(t&n)}}(t[s],e);[r[s],i[s]]=[l,u]}return[r,i]}(c,!0),B=(t,e,r)=>r>32?u(t,e,r):s(t,e,r),I=(t,e,r)=>r>32?a(t,e,r):l(t,e,r);class x extends f.kb{constructor(t,e,r,n=!1,o=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,i.Rx)(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,f.Jq)(this.state)}keccak(){(function(t,e=24){let r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let i=(e+8)%10,n=(e+2)%10,o=r[n],s=r[n+1],l=B(o,s,1)^r[i],u=I(o,s,1)^r[i+1];for(let r=0;r<50;r+=10)t[e+r]^=l,t[e+r+1]^=u}let e=t[2],n=t[3];for(let r=0;r<24;r++){let i=d[r],o=B(e,n,i),s=I(e,n,i),l=h[r];e=t[l],n=t[l+1],t[l]=o,t[l+1]=s}for(let e=0;e<50;e+=10){for(let i=0;i<10;i++)r[i]=t[e+i];for(let i=0;i<10;i++)t[e+i]^=~r[(i+2)%10]&r[(i+4)%10]}t[0]^=E[i],t[1]^=v[i]}r.fill(0)})(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){(0,i.Gg)(this);let{blockLen:e,state:r}=this,n=(t=(0,f.O0)(t)).length;for(let i=0;i<n;){let o=Math.min(e-this.pos,n-i);for(let e=0;e<o;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:i}=this;t[r]^=e,(128&e)!=0&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){(0,i.Gg)(this,!1),(0,i.aI)(t),this.finish();let e=this.state,{blockLen:r}=this;for(let i=0,n=t.length;i<n;){this.posOut>=r&&this.keccak();let o=Math.min(r-this.posOut,n-i);t.set(e.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,i.Rx)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,i.J8)(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:i,rounds:n,enableXOF:o}=this;return t||(t=new x(e,r,i,o,n)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=n,t.suffix=r,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}}let A=(0,f.hE)(()=>new x(136,1,32));var S=r(14925);let O=!1,P=function(t){return A(t)},N=P;function U(t){let e=(0,S.Pw)(t,"data");return(0,S.Dv)(N(e))}U._=P,U.lock=function(){O=!0},U.register=function(t){if(O)throw TypeError("keccak256 is locked");N=t},Object.freeze(U)},71926:(t,e,r)=>{r.d(e,{P:()=>p});let i="0x0000000000000000000000000000000000000000000000000000000000000000";var n=r(14925),o=r(33411),s=r(62819);let l=BigInt(0),u=BigInt(1),a=BigInt(2),f=BigInt(27),h=BigInt(28),d=BigInt(35),c={};function g(t){return(0,n.U3)((0,o.ot)(t),32)}class p{#t;#e;#r;#i;get r(){return this.#t}set r(t){(0,s.en)(32===(0,n.M5)(t),"invalid r","value",t),this.#t=(0,n.Dv)(t)}get s(){return(0,s.en)(8>parseInt(this.#e.substring(0,3)),"non-canonical s; use ._s","s",this.#e),this.#e}set s(t){(0,s.en)(32===(0,n.M5)(t),"invalid s","value",t),this.#e=(0,n.Dv)(t)}get _s(){return this.#e}isValid(){return 8>parseInt(this.#e.substring(0,3))}get v(){return this.#r}set v(t){let e=(0,o.Dx)(t,"value");(0,s.en)(27===e||28===e,"invalid v","v",t),this.#r=e}get networkV(){return this.#i}get legacyChainId(){let t=this.networkV;return null==t?null:p.getChainId(t)}get yParity(){return 27===this.v?0:1}get yParityAndS(){let t=(0,n.Pw)(this.s);return this.yParity&&(t[0]|=128),(0,n.Dv)(t)}get compactSerialized(){return(0,n.zo)([this.r,this.yParityAndS])}get serialized(){return(0,n.zo)([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(t,e,r,i){(0,s.NK)(t,c,"Signature"),this.#t=e,this.#e=r,this.#r=i,this.#i=null}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){let t=new p(c,this.r,this._s,this.v);return this.networkV&&(t.#i=this.networkV),t}toJSON(){let t=this.networkV;return{_type:"signature",networkV:null!=t?t.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(t){let e=(0,o.yT)(t,"v");return e==f||e==h?l:((0,s.en)(e>=d,"invalid EIP-155 v","v",t),(e-d)/a)}static getChainIdV(t,e){return(0,o.yT)(t)*a+BigInt(35+e-27)}static getNormalizedV(t){let e=(0,o.yT)(t);return e===l||e===f?27:e===u||e===h?28:((0,s.en)(e>=d,"invalid v","v",t),e&u?27:28)}static from(t){function e(e,r){(0,s.en)(e,r,"signature",t)}if(null==t)return new p(c,i,i,27);if("string"==typeof t){let r=(0,n.Pw)(t,"signature");if(64===r.length){let t=(0,n.Dv)(r.slice(0,32)),e=r.slice(32,64),i=128&e[0]?28:27;return e[0]&=127,new p(c,t,(0,n.Dv)(e),i)}if(65===r.length){let t=(0,n.Dv)(r.slice(0,32)),e=(0,n.Dv)(r.slice(32,64)),i=p.getNormalizedV(r[64]);return new p(c,t,e,i)}e(!1,"invalid raw signature length")}if(t instanceof p)return t.clone();let r=t.r;e(null!=r,"missing r");let l=g(r),u=function(t,r){if(null!=t)return g(t);if(null!=r){e((0,n.A7)(r,32),"invalid yParityAndS");let t=(0,n.Pw)(r);return t[0]&=127,(0,n.Dv)(t)}e(!1,"missing s")}(t.s,t.yParityAndS),{networkV:a,v:f}=function(t,r,i){if(null!=t){let e=(0,o.yT)(t);return{networkV:e>=d?e:void 0,v:p.getNormalizedV(e)}}if(null!=r)return e((0,n.A7)(r,32),"invalid yParityAndS"),{v:128&(0,n.Pw)(r)[0]?28:27};if(null!=i){switch((0,o.Dx)(i,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}e(!1,"invalid yParity")}e(!1,"missing v")}(t.v,t.yParityAndS,t.yParity),h=new p(c,l,u,f);return a&&(h.#i=a),e(null==t.yParity||(0,o.Dx)(t.yParity,"sig.yParity")===h.yParity,"yParity mismatch"),e(null==t.yParityAndS||t.yParityAndS===h.yParityAndS,"yParityAndS mismatch"),h}}},91405:(t,e,r)=>{r.d(e,{E:()=>ts});var i={};r.r(i),r.d(i,{dQ:()=>m,ci:()=>a,bytesToNumberBE:()=>d,ty:()=>c,eV:()=>w,n$:()=>v,ql:()=>y,hexToBytes:()=>h,tL:()=>g,S5:()=>p,FF:()=>I});var n=r(66632);BigInt(0);let o=BigInt(1),s=BigInt(2),l=t=>t instanceof Uint8Array,u=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function a(t){if(!l(t))throw Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=u[t[r]];return e}function f(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function h(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let e=0;e<r.length;e++){let i=2*e,n=Number.parseInt(t.slice(i,i+2),16);if(Number.isNaN(n)||n<0)throw Error("Invalid byte sequence");r[e]=n}return r}function d(t){return f(a(t))}function c(t){if(!l(t))throw Error("Uint8Array expected");return f(a(Uint8Array.from(t).reverse()))}function g(t,e){return h(t.toString(16).padStart(2*e,"0"))}function p(t,e){return g(t,e).reverse()}function y(t,e,r){let i;if("string"==typeof e)try{i=h(e)}catch(r){throw Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else if(l(e))i=Uint8Array.from(e);else throw Error(`${t} must be hex string or Uint8Array`);let n=i.length;if("number"==typeof r&&n!==r)throw Error(`${t} expected ${r} bytes, got ${n}`);return i}function w(...t){let e=new Uint8Array(t.reduce((t,e)=>t+e.length,0)),r=0;return t.forEach(t=>{if(!l(t))throw Error("Uint8Array expected");e.set(t,r),r+=t.length}),e}let m=t=>(s<<BigInt(t-1))-o,b=t=>new Uint8Array(t),E=t=>Uint8Array.from(t);function v(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=b(t),n=b(t),o=0,s=()=>{i.fill(1),n.fill(0),o=0},l=(...t)=>r(n,i,...t),u=(t=b())=>{n=l(E([0]),t),i=l(),0!==t.length&&(n=l(E([1]),t),i=l())},a=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){let e=(i=l()).slice();r.push(e),t+=i.length}return w(...r)};return(t,e)=>{let r;for(s(),u(t);!(r=e(a()));)u();return s(),r}}let B={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function I(t,e,r={}){let i=(e,r,i)=>{let n=B[r];if("function"!=typeof n)throw Error(`Invalid validator "${r}", expected function`);let o=t[e];if((!i||void 0!==o)&&!n(o,t))throw Error(`Invalid param ${String(e)}=${o} (${typeof o}), expected ${r}`)};for(let[t,r]of Object.entries(e))i(t,r,!1);for(let[t,e]of Object.entries(r))i(t,e,!0);return t}let x=BigInt(0),A=BigInt(1),S=BigInt(2),O=BigInt(3),P=BigInt(4),N=BigInt(5),U=BigInt(8);function R(t,e){let r=t%e;return r>=x?r:e+r}function L(t,e,r){let i=t;for(;e-- >x;)i*=i,i%=r;return i}function k(t,e){if(t===x||e<=x)throw Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=R(t,e),i=e,n=x,o=A,s=A,l=x;for(;r!==x;){let t=i/r,e=i%r,u=n-s*t,a=o-l*t;i=r,r=e,n=s,o=l,s=u,l=a}if(i!==A)throw Error("invert: does not exist");return R(n,e)}BigInt(9),BigInt(16);let q=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function C(t,e){let r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function V(t){if("bigint"!=typeof t)throw Error("field order must be bigint");return Math.ceil(t.toString(2).length/8)}function $(t){let e=V(t);return e+Math.ceil(e/2)}var H=r(17623),z=r(48578);let D=BigInt(0),_=BigInt(1);function F(t){return I(t.Fp,q.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),I(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...C(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}let{bytesToNumberBE:K,hexToBytes:T}=i,j={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){let{Err:e}=j;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");let r=t[1],i=t.subarray(2,r+2);if(!r||i.length!==r)throw new e("Invalid signature integer: wrong length");if(128&i[0])throw new e("Invalid signature integer: negative");if(0===i[0]&&!(128&i[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:K(i),l:t.subarray(r+2)}},toSig(t){let{Err:e}=j,r="string"==typeof t?T(t):t;if(!(r instanceof Uint8Array))throw Error("ui8a expected");let i=r.length;if(i<2||48!=r[0])throw new e("Invalid signature tag");if(r[1]!==i-2)throw new e("Invalid signature: incorrect length");let{d:n,l:o}=j._parseInt(r.subarray(2)),{d:s,l:l}=j._parseInt(o);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r:n,s}},hexFromSig(t){let e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,r=t=>{let e=t.toString(16);return 1&e.length?`0${e}`:e},i=e(r(t.s)),n=e(r(t.r)),o=i.length/2,s=n.length/2,l=r(o),u=r(s);return`30${r(s+o+4)}02${u}${n}02${l}${i}`}},Z=BigInt(0),G=BigInt(1),M=(BigInt(2),BigInt(3)),Y=(BigInt(4),BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f")),W=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),X=BigInt(1),J=BigInt(2),Q=(t,e)=>(t+e/J)/e,tt=function(t,e,r=!1,i={}){if(t<=x)throw Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:n,nByteLength:o}=C(t,e);if(o>2048)throw Error("Field lengths over 2048 bytes are not supported");let s=function(t){if(t%P===O){let e=(t+A)/P;return function(t,r){let i=t.pow(r,e);if(!t.eql(t.sqr(i),r))throw Error("Cannot find square root");return i}}if(t%U===N){let e=(t-N)/U;return function(t,r){let i=t.mul(r,S),n=t.pow(i,e),o=t.mul(r,n),s=t.mul(t.mul(o,S),n),l=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(l),r))throw Error("Cannot find square root");return l}}return function(t){let e,r,i;let n=(t-A)/S;for(e=t-A,r=0;e%S===x;e/=S,r++);for(i=S;i<t&&function(t,e,r){if(r<=x||e<x)throw Error("Expected power/modulo > 0");if(r===A)return x;let i=A;for(;e>x;)e&A&&(i=i*t%r),t=t*t%r,e>>=A;return i}(i,n,t)!==t-A;i++);if(1===r){let e=(t+A)/P;return function(t,r){let i=t.pow(r,e);if(!t.eql(t.sqr(i),r))throw Error("Cannot find square root");return i}}let o=(e+A)/S;return function(t,s){if(t.pow(s,n)===t.neg(t.ONE))throw Error("Cannot find square root");let l=r,u=t.pow(t.mul(t.ONE,i),e),a=t.pow(s,o),f=t.pow(s,e);for(;!t.eql(f,t.ONE);){if(t.eql(f,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(f);e<l&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(u,A<<BigInt(l-e-1));u=t.sqr(r),a=t.mul(a,r),f=t.mul(f,u),l=e}return a}}(t)}(t),l=Object.freeze({ORDER:t,BITS:n,BYTES:o,MASK:m(n),ZERO:x,ONE:A,create:e=>R(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error(`Invalid field element: expected bigint, got ${typeof e}`);return x<=e&&e<t},is0:t=>t===x,isOdd:t=>(t&A)===A,neg:e=>R(-e,t),eql:(t,e)=>t===e,sqr:e=>R(e*e,t),add:(e,r)=>R(e+r,t),sub:(e,r)=>R(e-r,t),mul:(e,r)=>R(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<x)throw Error("Expected power > 0");if(r===x)return t.ONE;if(r===A)return e;let i=t.ONE,n=e;for(;r>x;)r&A&&(i=t.mul(i,n)),n=t.sqr(n),r>>=A;return i})(l,t,e),div:(e,r)=>R(e*k(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>k(e,t),sqrt:i.sqrt||(t=>s(l,t)),invertBatch:t=>(function(t,e){let r=Array(e.length),i=e.reduce((e,i,n)=>t.is0(i)?e:(r[n]=e,t.mul(e,i)),t.ONE),n=t.inv(i);return e.reduceRight((e,i,n)=>t.is0(i)?e:(r[n]=t.mul(e,r[n]),t.mul(e,i)),n),r})(l,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?p(t,o):g(t,o),fromBytes:t=>{if(t.length!==o)throw Error(`Fp.fromBytes: expected ${o}, got ${t.length}`);return r?c(t):d(t)}});return Object.freeze(l)}(Y,void 0,void 0,{sqrt:function(t){let e=BigInt(3),r=BigInt(6),i=BigInt(11),n=BigInt(22),o=BigInt(23),s=BigInt(44),l=BigInt(88),u=t*t*t%Y,a=u*u*t%Y,f=L(a,e,Y)*a%Y,h=L(f,e,Y)*a%Y,d=L(h,J,Y)*u%Y,c=L(d,i,Y)*d%Y,g=L(c,n,Y)*c%Y,p=L(g,s,Y)*g%Y,y=L(p,l,Y)*p%Y,w=L(y,s,Y)*g%Y,m=L(w,e,Y)*a%Y,b=L(m,o,Y)*c%Y,E=L(b,r,Y)*u%Y,v=L(E,J,Y);if(!tt.eql(tt.sqr(v),t))throw Error("Cannot find square root");return v}}),te=function(t,e){let r=e=>(function(t){let e=function(t){let e=F(t);return I(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n:i}=e,n=r.BYTES+1,o=2*r.BYTES+1;function s(t){return R(t,i)}let{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:f,isWithinCurveOrder:b}=function(t){let e=function(t){let e=F(t);I(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:i,a:n}=e;if(r){if(!i.eql(n,i.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,i=e.toBytes||((t,e,i)=>{let n=e.toAffine();return w(Uint8Array.from([4]),r.toBytes(n.x),r.toBytes(n.y))}),n=e.fromBytes||(t=>{let e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){let{a:i,b:n}=e,o=r.sqr(t),s=r.mul(o,t);return r.add(r.add(s,r.mul(t,i)),n)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw Error("bad generator point: equation left != right");function s(t){return"bigint"==typeof t&&Z<t&&t<e.n}function l(t){if(!s(t))throw Error("Expected valid bigint: 0 < bigint < curve.n")}function u(t){let r;let{allowedPrivateKeyLengths:i,nByteLength:n,wrapPrivateKey:o,n:s}=e;if(i&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=a(t)),"string"!=typeof t||!i.includes(t.length))throw Error("Invalid key");t=t.padStart(2*n,"0")}try{r="bigint"==typeof t?t:d(y("private key",t,n))}catch(e){throw Error(`private key must be ${n} bytes, hex or bigint, not ${typeof t}`)}return o&&(r=R(r,s)),l(r),r}let f=new Map;function h(t){if(!(t instanceof c))throw Error("ProjectivePoint expected")}class c{constructor(t,e,i){if(this.px=t,this.py=e,this.pz=i,null==t||!r.isValid(t))throw Error("x required");if(null==e||!r.isValid(e))throw Error("y required");if(null==i||!r.isValid(i))throw Error("z required")}static fromAffine(t){let{x:e,y:i}=t||{};if(!t||!r.isValid(e)||!r.isValid(i))throw Error("invalid affine point");if(t instanceof c)throw Error("projective point not allowed");let n=t=>r.eql(t,r.ZERO);return n(e)&&n(i)?c.ZERO:new c(e,i,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(c.fromAffine)}static fromHex(t){let e=c.fromAffine(n(y("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return c.BASE.multiply(u(t))}_setWindowSize(t){this._WINDOW_SIZE=t,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw Error("bad point: ZERO")}let{x:t,y:i}=this.toAffine();if(!r.isValid(t)||!r.isValid(i))throw Error("bad point: x or y not FE");let n=r.sqr(i),s=o(t);if(!r.eql(n,s))throw Error("bad point: equation left != right");if(!this.isTorsionFree())throw Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){h(t);let{px:e,py:i,pz:n}=this,{px:o,py:s,pz:l}=t,u=r.eql(r.mul(e,l),r.mul(o,n)),a=r.eql(r.mul(i,l),r.mul(s,n));return u&&a}negate(){return new c(this.px,r.neg(this.py),this.pz)}double(){let{a:t,b:i}=e,n=r.mul(i,M),{px:o,py:s,pz:l}=this,u=r.ZERO,a=r.ZERO,f=r.ZERO,h=r.mul(o,o),d=r.mul(s,s),g=r.mul(l,l),p=r.mul(o,s);return p=r.add(p,p),f=r.mul(o,l),f=r.add(f,f),u=r.mul(t,f),a=r.mul(n,g),a=r.add(u,a),u=r.sub(d,a),a=r.add(d,a),a=r.mul(u,a),u=r.mul(p,u),f=r.mul(n,f),g=r.mul(t,g),p=r.sub(h,g),p=r.mul(t,p),p=r.add(p,f),f=r.add(h,h),h=r.add(f,h),h=r.add(h,g),h=r.mul(h,p),a=r.add(a,h),g=r.mul(s,l),g=r.add(g,g),h=r.mul(g,p),u=r.sub(u,h),f=r.mul(g,d),f=r.add(f,f),new c(u,a,f=r.add(f,f))}add(t){h(t);let{px:i,py:n,pz:o}=this,{px:s,py:l,pz:u}=t,a=r.ZERO,f=r.ZERO,d=r.ZERO,g=e.a,p=r.mul(e.b,M),y=r.mul(i,s),w=r.mul(n,l),m=r.mul(o,u),b=r.add(i,n),E=r.add(s,l);b=r.mul(b,E),E=r.add(y,w),b=r.sub(b,E),E=r.add(i,o);let v=r.add(s,u);return E=r.mul(E,v),v=r.add(y,m),E=r.sub(E,v),v=r.add(n,o),a=r.add(l,u),v=r.mul(v,a),a=r.add(w,m),v=r.sub(v,a),d=r.mul(g,E),a=r.mul(p,m),d=r.add(a,d),a=r.sub(w,d),d=r.add(w,d),f=r.mul(a,d),w=r.add(y,y),w=r.add(w,y),m=r.mul(g,m),E=r.mul(p,E),w=r.add(w,m),m=r.sub(y,m),m=r.mul(g,m),E=r.add(E,m),y=r.mul(w,E),f=r.add(f,y),y=r.mul(v,E),a=r.mul(b,a),a=r.sub(a,y),y=r.mul(b,w),d=r.mul(v,d),new c(a,f,d=r.add(d,y))}subtract(t){return this.add(t.negate())}is0(){return this.equals(c.ZERO)}wNAF(t){return p.wNAFCached(this,f,t,t=>{let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(c.fromAffine)})}multiplyUnsafe(t){let i=c.ZERO;if(t===Z)return i;if(l(t),t===G)return this;let{endo:n}=e;if(!n)return p.unsafeLadder(this,t);let{k1neg:o,k1:s,k2neg:u,k2:a}=n.splitScalar(t),f=i,h=i,d=this;for(;s>Z||a>Z;)s&G&&(f=f.add(d)),a&G&&(h=h.add(d)),d=d.double(),s>>=G,a>>=G;return o&&(f=f.negate()),u&&(h=h.negate()),h=new c(r.mul(h.px,n.beta),h.py,h.pz),f.add(h)}multiply(t){let i,n;l(t);let{endo:o}=e;if(o){let{k1neg:e,k1:s,k2neg:l,k2:u}=o.splitScalar(t),{p:a,f:f}=this.wNAF(s),{p:h,f:d}=this.wNAF(u);a=p.constTimeNegate(e,a),h=p.constTimeNegate(l,h),h=new c(r.mul(h.px,o.beta),h.py,h.pz),i=a.add(h),n=f.add(d)}else{let{p:e,f:r}=this.wNAF(t);i=e,n=r}return c.normalizeZ([i,n])[0]}multiplyAndAddUnsafe(t,e,r){let i=c.BASE,n=(t,e)=>e!==Z&&e!==G&&t.equals(i)?t.multiply(e):t.multiplyUnsafe(e),o=n(this,e).add(n(t,r));return o.is0()?void 0:o}toAffine(t){let{px:e,py:i,pz:n}=this,o=this.is0();null==t&&(t=o?r.ONE:r.inv(n));let s=r.mul(e,t),l=r.mul(i,t),u=r.mul(n,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw Error("invZ was invalid");return{x:s,y:l}}isTorsionFree(){let{h:t,isTorsionFree:r}=e;if(t===G)return!0;if(r)return r(c,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:r}=e;return t===G?this:r?r(c,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),i(c,this,t)}toHex(t=!0){return a(this.toRawBytes(t))}}c.BASE=new c(e.Gx,e.Gy,r.ONE),c.ZERO=new c(r.ZERO,r.ONE,r.ZERO);let g=e.nBitLength,p=function(t,e){let r=(t,e)=>{let r=e.negate();return t?r:e},i=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let i=t.ZERO,n=e;for(;r>D;)r&_&&(i=i.add(n)),n=n.double(),r>>=_;return i},precomputeWindow(t,e){let{windows:r,windowSize:n}=i(e),o=[],s=t,l=s;for(let t=0;t<r;t++){l=s,o.push(l);for(let t=1;t<n;t++)l=l.add(s),o.push(l);s=l.double()}return o},wNAF(e,n,o){let{windows:s,windowSize:l}=i(e),u=t.ZERO,a=t.BASE,f=BigInt(2**e-1),h=2**e,d=BigInt(e);for(let t=0;t<s;t++){let e=t*l,i=Number(o&f);o>>=d,i>l&&(i-=h,o+=_);let s=e+Math.abs(i)-1,c=t%2!=0,g=i<0;0===i?a=a.add(r(c,n[e])):u=u.add(r(g,n[s]))}return{p:u,f:a}},wNAFCached(t,e,r,i){let n=t._WINDOW_SIZE||1,o=e.get(t);return o||(o=this.precomputeWindow(t,n),1!==n&&e.set(t,i(o))),this.wNAF(n,o,r)}}}(c,e.endo?Math.ceil(g/2):g);return{CURVE:e,ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:o,isWithinCurveOrder:s}}({...e,toBytes(t,e,i){let n=e.toAffine(),o=r.toBytes(n.x),s=w;return i?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,r.toBytes(n.y))},fromBytes(t){let e=t.length,i=t[0],s=t.subarray(1);if(e===n&&(2===i||3===i)){let t=d(s);if(!(Z<t&&t<r.ORDER))throw Error("Point is not on curve");let e=f(t),n=r.sqrt(e);return(1&i)==1!=((n&G)===G)&&(n=r.neg(n)),{x:t,y:n}}if(e===o&&4===i)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw Error(`Point of length ${e} was invalid. Expected ${n} compressed bytes or ${o} uncompressed bytes`)}}),E=t=>a(g(t,e.nByteLength)),B=(t,e,r)=>d(t.slice(e,r));class x{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){let r=e.nByteLength;return new x(B(t=y("compactSignature",t,2*r),0,r),B(t,r,2*r))}static fromDER(t){let{r:e,s:r}=j.toSig(y("DER",t));return new x(e,r)}assertValidity(){if(!b(this.r))throw Error("r must be 0 < r < CURVE.n");if(!b(this.s))throw Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new x(this.r,this.s,t)}recoverPublicKey(t){let{r:n,s:o,recovery:u}=this,a=P(y("msgHash",t));if(null==u||![0,1,2,3].includes(u))throw Error("recovery id invalid");let f=2===u||3===u?n+e.n:n;if(f>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let h=(1&u)==0?"02":"03",d=l.fromHex(h+E(f)),c=k(f,i),g=s(-a*c),p=s(o*c),w=l.BASE.multiplyAndAddUnsafe(d,g,p);if(!w)throw Error("point at infinify");return w.assertValidity(),w}hasHighS(){return this.s>i>>G}normalizeS(){return this.hasHighS()?new x(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return h(this.toDERHex())}toDERHex(){return j.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return h(this.toCompactHex())}toCompactHex(){return E(this.r)+E(this.s)}}function S(t){let e=t instanceof Uint8Array,r="string"==typeof t,i=(e||r)&&t.length;return e?i===n||i===o:r?i===2*n||i===2*o:t instanceof l}let O=e.bits2int||function(t){let r=d(t),i=8*t.length-e.nBitLength;return i>0?r>>BigInt(i):r},P=e.bits2int_modN||function(t){return s(O(t))},N=m(e.nBitLength);function U(t){if("bigint"!=typeof t)throw Error("bigint expected");if(!(Z<=t&&t<N))throw Error(`bigint expected < 2^${e.nBitLength}`);return g(t,e.nByteLength)}let L={lowS:e.lowS,prehash:!1},q={lowS:e.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return l.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(S(t))throw Error("first arg must be private key");if(!S(e))throw Error("second arg must be public key");return l.fromHex(e).multiply(u(t)).toRawBytes(r)},sign:function(t,n,o=L){let{seed:a,k2sig:f}=function(t,n,o=L){if(["recovered","canonical"].some(t=>t in o))throw Error("sign() legacy options not supported");let{hash:a,randomBytes:f}=e,{lowS:h,prehash:d,extraEntropy:c}=o;null==h&&(h=!0),t=y("msgHash",t),d&&(t=y("prehashed msgHash",a(t)));let g=P(t),p=u(n),m=[U(p),U(g)];if(null!=c){let t=!0===c?f(r.BYTES):c;m.push(y("extraEntropy",t))}return{seed:w(...m),k2sig:function(t){let e=O(t);if(!b(e))return;let r=k(e,i),n=l.BASE.multiply(e).toAffine(),o=s(n.x);if(o===Z)return;let u=s(r*s(g+o*p));if(u===Z)return;let a=(n.x===o?0:2)|Number(n.y&G),f=u;if(h&&u>i>>G)f=u>i>>G?s(-u):u,a^=1;return new x(o,f,a)}}}(t,n,o);return v(e.hash.outputLen,e.nByteLength,e.hmac)(a,f)},verify:function(t,r,n,o=q){let u,a;if(r=y("msgHash",r),n=y("publicKey",n),"strict"in o)throw Error("options.strict was renamed to lowS");let{lowS:f,prehash:h}=o;try{if("string"==typeof t||t instanceof Uint8Array)try{a=x.fromDER(t)}catch(e){if(!(e instanceof j.Err))throw e;a=x.fromCompact(t)}else if("object"==typeof t&&"bigint"==typeof t.r&&"bigint"==typeof t.s){let{r:e,s:r}=t;a=new x(e,r)}else throw Error("PARSE");u=l.fromHex(n)}catch(t){if("PARSE"===t.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(f&&a.hasHighS())return!1;h&&(r=e.hash(r));let{r:d,s:c}=a,g=P(r),p=k(c,i),w=s(g*p),m=s(d*p),b=l.BASE.multiplyAndAddUnsafe(u,w,m)?.toAffine();return!!b&&s(b.x)===d},ProjectivePoint:l,Signature:x,utils:{isValidPrivateKey(t){try{return u(t),!0}catch(t){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let t=$(e.n);return function(t,e,r=!1){let i=t.length,n=V(e),o=$(e);if(i<16||i<o||i>1024)throw Error(`expected ${o}-1024 bytes of input, got ${i}`);let s=R(r?d(t):c(t),e-A)+A;return r?p(s,n):g(s,n)}(e.randomBytes(t),e.n)},precompute:(t=8,e=l.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}})({...t,hash:e,hmac:(t,...r)=>(0,H.b)(e,t,(0,z.eV)(...r)),randomBytes:z.O6});return Object.freeze({...r(e),create:r})}({a:BigInt(0),b:BigInt(7),Fp:tt,n:W,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-X*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),n=BigInt("0x100000000000000000000000000000000"),o=Q(e*t,W),s=Q(-r*t,W),l=R(t-o*e-s*i,W),u=R(-o*r-s*e,W),a=l>n,f=u>n;if(a&&(l=W-l),f&&(u=W-u),l>n||u>n)throw Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:a,k1:l,k2neg:f,k2:u}}}},n.J);BigInt(0),te.ProjectivePoint;var tr=r(62819),ti=r(14925),tn=r(33411),to=r(71926);class ts{#n;constructor(t){(0,tr.en)(32===(0,ti.M5)(t),"invalid private key","privateKey","[REDACTED]"),this.#n=(0,ti.Dv)(t)}get privateKey(){return this.#n}get publicKey(){return ts.computePublicKey(this.#n)}get compressedPublicKey(){return ts.computePublicKey(this.#n,!0)}sign(t){(0,tr.en)(32===(0,ti.M5)(t),"invalid digest length","digest",t);let e=te.sign((0,ti.h_)(t),(0,ti.h_)(this.#n),{lowS:!0});return to.P.from({r:(0,tn.m9)(e.r,32),s:(0,tn.m9)(e.s,32),v:e.recovery?28:27})}computeSharedSecret(t){let e=ts.computePublicKey(t);return(0,ti.Dv)(te.getSharedSecret((0,ti.h_)(this.#n),(0,ti.Pw)(e),!1))}static computePublicKey(t,e){let r=(0,ti.Pw)(t,"key");if(32===r.length){let t=te.getPublicKey(r,!!e);return(0,ti.Dv)(t)}if(64===r.length){let t=new Uint8Array(65);t[0]=4,t.set(r,1),r=t}let i=te.ProjectivePoint.fromHex(r);return(0,ti.Dv)(i.toRawBytes(e))}static recoverPublicKey(t,e){(0,tr.en)(32===(0,ti.M5)(t),"invalid digest length","digest",t);let r=to.P.from(e),i=te.Signature.fromCompact((0,ti.h_)((0,ti.zo)([r.r,r.s]))),n=(i=i.addRecoveryBit(r.yParity)).recoverPublicKey((0,ti.h_)(t));return(0,tr.en)(null!=n,"invalid signature for digest","signature",e),"0x"+n.toHex(!1)}static addPoints(t,e,r){let i=te.ProjectivePoint.fromHex(ts.computePublicKey(t).substring(2)),n=te.ProjectivePoint.fromHex(ts.computePublicKey(e).substring(2));return"0x"+i.add(n).toHex(!!r)}}},96688:(t,e,r)=>{r.d(e,{R:()=>l,d:()=>s});var i=r(22736),n=r(91405),o=r(83045);function s(t){let e;return e="string"==typeof t?n.E.computePublicKey(t,!1):t.publicKey,(0,i.K)((0,o.w)("0x"+e.substring(4)).substring(26))}function l(t,e){return s(n.E.recoverPublicKey(t,e))}},13341:(t,e,r)=>{r.d(e,{Y0:()=>l,ZN:()=>u});var i=r(14925),n=r(62819);function o(t,e,r,i,n){if("BAD_PREFIX"===t||"UNEXPECTED_CONTINUE"===t){let t=0;for(let i=e+1;i<r.length&&r[i]>>6==2;i++)t++;return t}return"OVERRUN"===t?r.length-e-1:0}let s=Object.freeze({error:function(t,e,r,i,o){(0,n.en)(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",r)},ignore:o,replace:function(t,e,r,i,s){return"OVERLONG"===t?((0,n.en)("number"==typeof s,"invalid bad code point for replacement","badCodepoint",s),i.push(s),0):(i.push(65533),o(t,e,r,i,s))}});function l(t,e){(0,n.en)("string"==typeof t,"invalid string value","str",t),null!=e&&((0,n.fA)(e),t=t.normalize(e));let r=[];for(let e=0;e<t.length;e++){let i=t.charCodeAt(e);if(i<128)r.push(i);else if(i<2048)r.push(i>>6|192),r.push(63&i|128);else if((64512&i)==55296){e++;let o=t.charCodeAt(e);(0,n.en)(e<t.length&&(64512&o)==56320,"invalid surrogate pair","str",t);let s=65536+((1023&i)<<10)+(1023&o);r.push(s>>18|240),r.push(s>>12&63|128),r.push(s>>6&63|128),r.push(63&s|128)}else r.push(i>>12|224),r.push(i>>6&63|128),r.push(63&i|128)}return new Uint8Array(r)}function u(t,e){return(function(t,e){null==e&&(e=s.error);let r=(0,i.Pw)(t,"bytes"),n=[],o=0;for(;o<r.length;){let t=r[o++];if(t>>7==0){n.push(t);continue}let i=null,s=null;if((224&t)==192)i=1,s=127;else if((240&t)==224)i=2,s=2047;else if((248&t)==240)i=3,s=65535;else{(192&t)==128?o+=e("UNEXPECTED_CONTINUE",o-1,r,n):o+=e("BAD_PREFIX",o-1,r,n);continue}if(o-1+i>=r.length){o+=e("OVERRUN",o-1,r,n);continue}let l=t&(1<<8-i-1)-1;for(let t=0;t<i;t++){let t=r[o];if((192&t)!=128){o+=e("MISSING_CONTINUE",o,r,n),l=null;break}l=l<<6|63&t,o++}if(null!==l){if(l>1114111){o+=e("OUT_OF_RANGE",o-1-i,r,n,l);continue}if(l>=55296&&l<=57343){o+=e("UTF16_SURROGATE",o-1-i,r,n,l);continue}if(l<=s){o+=e("OVERLONG",o-1-i,r,n,l);continue}n.push(l)}}return n})(t,e).map(t=>t<=65535?String.fromCharCode(t):String.fromCharCode(((t-=65536)>>10&1023)+55296,(1023&t)+56320)).join("")}}};